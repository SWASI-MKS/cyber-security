import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { AlertCircle, AlertTriangle, Info, CheckCircle } from "lucide-react";

const vulnerabilities = [
  {
    severity: "critical",
    type: "SQL Injection",
    file: "handlers/User.cfc",
    line: 42,
    description: "Unsanitized user input in database query",
    icon: AlertCircle
  },
  {
    severity: "high",
    type: "Cross-Site Scripting (XSS)",
    file: "views/profile/show.cfm",
    line: 18,
    description: "Unescaped user content rendering",
    icon: AlertTriangle
  },
  {
    severity: "medium",
    type: "Session Fixation",
    file: "interceptors/Security.cfc",
    line: 67,
    description: "Session ID not regenerated after login",
    icon: AlertTriangle
  },
  {
    severity: "low",
    type: "Information Disclosure",
    file: "config/ColdBox.cfc",
    line: 15,
    description: "Debug mode enabled in production config",
    icon: Info
  }
];

const severityConfig = {
  critical: {
    color: "bg-critical text-critical-foreground",
    label: "Critical"
  },
  high: {
    color: "bg-high text-high-foreground",
    label: "High"
  },
  medium: {
    color: "bg-medium text-medium-foreground",
    label: "Medium"
  },
  low: {
    color: "bg-low text-low-foreground",
    label: "Low"
  }
};

export const VulnerabilityDashboard = () => {
  return (
    <section className="py-24 px-4 bg-muted/30">
      <div className="container mx-auto max-w-6xl">
        <div className="text-center space-y-4 mb-16">
          <h2 className="text-4xl md:text-5xl font-bold tracking-tight">
            Detailed{" "}
            <span className="text-primary">Security Reports</span>
          </h2>
          <p className="text-xl text-muted-foreground max-w-2xl mx-auto">
            Clear, actionable insights with precise locations and fix recommendations
          </p>
        </div>
        
        <div className="grid gap-6 mb-8">
          <Card className="border-2">
            <CardHeader>
              <div className="flex items-center justify-between">
                <CardTitle>Security Scan Results</CardTitle>
                <Badge className="bg-secure text-secure-foreground">
                  <CheckCircle className="w-3 h-3 mr-1" />
                  Scan Complete
                </Badge>
              </div>
              <CardDescription>
                Latest scan: main branch • commit a3f2b1c • 2 minutes ago
              </CardDescription>
            </CardHeader>
          </Card>
          
          {vulnerabilities.map((vuln, index) => (
            <Card 
              key={index}
              className="border-2 hover:shadow-[var(--shadow-soft)] transition-all duration-300"
            >
              <CardHeader>
                <div className="flex items-start justify-between gap-4">
                  <div className="flex gap-3 flex-1">
                    <div className={`p-2 rounded-lg ${severityConfig[vuln.severity as keyof typeof severityConfig].color} bg-opacity-10`}>
                      <vuln.icon className={`w-5 h-5 ${severityConfig[vuln.severity as keyof typeof severityConfig].color.split(' ')[0].replace('bg-', 'text-')}`} />
                    </div>
                    <div className="flex-1">
                      <div className="flex items-center gap-2 mb-2">
                        <CardTitle className="text-lg">{vuln.type}</CardTitle>
                        <Badge className={severityConfig[vuln.severity as keyof typeof severityConfig].color}>
                          {severityConfig[vuln.severity as keyof typeof severityConfig].label}
                        </Badge>
                      </div>
                      <CardDescription className="text-base mb-2">
                        {vuln.description}
                      </CardDescription>
                      <div className="flex items-center gap-4 text-sm text-muted-foreground">
                        <span className="font-mono">{vuln.file}</span>
                        <span>Line {vuln.line}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </CardHeader>
            </Card>
          ))}
        </div>
        
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
          <Card className="border-2 border-critical/20">
            <CardContent className="pt-6">
              <div className="text-3xl font-bold text-critical">1</div>
              <div className="text-sm text-muted-foreground">Critical</div>
            </CardContent>
          </Card>
          <Card className="border-2 border-high/20">
            <CardContent className="pt-6">
              <div className="text-3xl font-bold text-high">1</div>
              <div className="text-sm text-muted-foreground">High</div>
            </CardContent>
          </Card>
          <Card className="border-2 border-medium/20">
            <CardContent className="pt-6">
              <div className="text-3xl font-bold text-medium">1</div>
              <div className="text-sm text-muted-foreground">Medium</div>
            </CardContent>
          </Card>
          <Card className="border-2 border-low/20">
            <CardContent className="pt-6">
              <div className="text-3xl font-bold text-low">1</div>
              <div className="text-sm text-muted-foreground">Low</div>
            </CardContent>
          </Card>
        </div>
      </div>
    </section>
  );
};
